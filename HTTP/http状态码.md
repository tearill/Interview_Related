# HTTP 状态码  
RFC 规定 HTTP 状态码为三位数，分为五类：  
- 1XX: 表示目前是协议处理的中间状态，还需要后续操作  
- 2XX: 表示成功状态  
- 3XX: 重定向状态，资源位置发生变动，需要重新请求  
- 4XX: 请求报文有误  
- 5XX: 服务器端发生错误  

# 1XX  
1. 101：Switching Protocols：在 HTTP 升级为 WebSocket 的时候，如果服务器同意变更，就会发送状态码 101  

## 2XX  
1. 200：**请求已成功**，通常在响应体中放有数据  
  > 考了双百，感觉非常 OK  
2. 204：No Content 含义与 200 相同，但是**响应头后没有 body 数据**  
3. 206：Partial Content 表示**部分内容**，使用场景是 **HTTP 分块下载和断点续传**，会带上相应的响应头字段 `Content-Range`  

## 3XX  
> 3 就是闪了的意思 -> 重定向  
1. 301：Moved Permanently **永久重定向**  
2. 302：**临时重定向**，请求成功但是被重定向(例如登录鉴权)  
3. 303：**临时重定向**，表示客户端当前应采用 GET 方法获取资源，POST 请求会变为 GET 请求进行重定向  
4. 304：Not Modified，当**协商缓存命中时**会返回这个状态码  
5. 305：Use Proxy，请求的资源必须通过指定的代理才能被访问  
5. 307：**临时重定向**，不会从 POST 变为 GET  
> 如果网站从 HTTP 升级到 HTTPS，以前的站点不能再使用了，应该返回 301，浏览器默认会做缓存优化，在第二次访问的时候自动访问重定向的那个地址  
> 如果只是暂时不用，直接返回 302，和 301 不同的是，浏览器不会做缓存优化  

## 4XX  
> 4 你这个请求似不似有问题  
1. 400：Bad Request  
  - **语义有误**，当前请求无法被服务器理解，除非进行修改，否则客户端不应该重复提交这个请求
  - **请求参数有误**  
2. 401: Unauthorized，当前请求需要用户验证，**该响应必须包含一个适用于被请求资源的 WWW-Authenticate 信息头用以询问用户信息**  
2. 403：Forbidden，服务器**已经理解请求，但拒绝执行它**，原因有很多，比如法律禁止、信息敏感  
  > 闪开，你不配获得它  
3. 404：Not Found，**资源未找到**，表示未在服务器上找到相应的资源  
  > 不是，没有，什么网页，不存在的  
4. 405：Method Not Allowed：**请求方法不被服务端允许**  
5. 408：Request Timeout，**请求超时**，客户端没有在服务器预备等待的时间内完成一个请求的发送  
6. 409：Conflict：**多个请求发生了冲突**  

## 5XX  
> 5 我的锅  
1. 500：Internal Server Error：**服务器遇到了一个未曾预料的状况，导致了它无法完成对请求的处理**，一般错误出现在服务端源码  
2. 501：Not Implemented，表示**客户端请求的功能还不支持**  
3. 502：Bad Gateway，**服务器自身是正常的，但是访问的时候出错了**  
4. 503：Service Unavailable，表示**临时的服务器维护或过载，暂时无法响应服务**  
5. 504：Gateway Timeout，服务器作为网关或代理，但是**没有及时从上游服务器收到请求**  

## 重定向和跳转管理  
- 重定向实际上是发起了两个 HTTP 请求，必须配合服务器端返回的 location 字段一起完成跳转  
- 重定向是“用户无感知”的  
- 浏览器收到 301/302 报文，会检查响应头里有没有“Location”。如果有，就从字段值里提取出 URI，发出新的 HTTP 请求，相当于自动替用户点击了这个链接  

### 重定向状态码的区别  
1. 301：永久重定向，意思是原 URI 已经“永久”性地不存在了，今后的所有请求都必须改用新的 URI  
  浏览器收到 301 状态码的响应后，就知道原来的 URI 已经“过时”了，就会进行一定的缓存优化，省去再次跳转的成本  
  搜索引擎的爬虫看到 301 状态码也会去更新索引库，不再使用原来的 URI  

2. 302：临时重定向，意思是原 URI 处于“临时维护”状态，新的 URI 是起“顶包”作用的“临时工”  
  浏览器或爬虫看到 302 状态码，会认为原来的 URI 还有效，所以只会执行简单的页面跳转，不会记录新的 URI，下次访问还是使用原来的 URI  

3. 303：See Other，类似 302，但是要求重定向后将请求方法改为 GET，避免 PUT/POST 重复操作造成副作用  

4. 307：Temporary Redirect，类似 302，但重定向后请求里的方法和实体不允许变动，含义比 302 更明确  

5. 308：Permanent Redirect：类似 307，不允许重定向后的请求变动，但它是 301“永久重定向”的含义  

### 应用场景  
1. 资源不可用，例如域名变更、服务器变更、网站改版、系统维护  
2. 避免重复，让多个网址都跳转到一个 URI，增加访问入口的同时还不会增加额外的工作量  
  多个域名指向同一个服务器  

### 重定向的相关问题  
1. 性能损耗：重定向的机制决定它必须发起两次请求，相比正常访问会多一次  
  虽然 301/302 报文很小，但大量的跳转对服务器的影响也是不可忽视的。站内重定向可以长连接复用，但站外重定向就要开两个连接，如果网络连接质量差，那成本可就高多了，会严重影响用户的体验  

2. 循环跳转：如果重定向的策略设计有问题，可能会出现 A => B => C => A 的无限循环  
  HTTP 协议特别规定：浏览器必须拥有循环检测的能力，在发现循环跳转的情况下应该停止发送请求并给出错误提示  
