# 为什么要使用 Immutable 数据流  

## React 种的优化方案  
- PureComponent(memo) 进行浅层比较  
  PureComponent 或者 memo 将会进行新旧数据的浅层比对  

  浅层比较之下  
  ```js
  // 调用 state.a.push("2")
  state: {a: ["1"]} -> state: {a: ["1", "2"]}
  ```
  a 数组已经改变了，但是浅层比较会表示没有改变，因为数组的引用没有变  
  这就是这种方式最大的弊端，由于 JS 引用赋值的原因，这种方式仅仅适用于无状态组件或者状态数据非常简单的组件，对于大量的应用型组件，它是无能为力的  

- shouldComponentUpdate 深层比较  
  把 props 中所有的属性和值进行递归比对  
  访问到对象的属性值的时候，再将属性值进行递归对比  
  极端情况：当有很多很多数据的时候，只有最后一个属性发生了改变，但需要将所有的属性都遍历一遍，非常浪费性能  

- immutable 数据结构 + SCU(memo) 浅层对比  
  - 什么是 immutable 数据？有什么优势？  
    immutable 数据一种利用结构共享形成的持久化数据结构，一旦有部分被修改，那么将会返回一个全新的对象，并且原来相同的节点会直接共享  

    immutable 对象数据内部采用的是多叉树的数据结构，一旦有节点被改变，和它相关的所有上级节点都会更新  

    采用 immutable 既能够最大效率地更新数据结构，又能够和现有的 PureComponent (memo) 顺利对接，感知到状态的变化，是提高 React 渲染性能的极佳方案  

    